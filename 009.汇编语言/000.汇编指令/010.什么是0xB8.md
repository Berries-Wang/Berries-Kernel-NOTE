# 什么是 0xB8
`0xB8` 是 **x86/x86-64** 架构中的一个单字节机器码，对应的汇编指令是 **`MOV EAX, imm32`**（32 位模式）或 **`MOV RAX, imm64`**（64 位模式）。  

---

## **指令详解**
### **1. 指令功能**
- **作用**：将 **32 位（或 64 位）立即数** 加载到 **`EAX`（32 位）或 `RAX`（64 位）** 寄存器。
- **格式**：
  - **32 位模式**：`MOV EAX, 0x12345678`  
    **机器码**：`B8 78 56 34 12`（小端字节序）
  - **64 位模式**：`MOV RAX, 0x123456789ABCDEF0`  
    **机器码**：`48 B8 F0 DE BC 9A 78 56 34 12`（`48` 是 REX.W 前缀，表示 64 位操作）

---

### **2. 指令解析**
#### **（1）操作码（Opcode）**
- `0xB8` 是 `MOV EAX/RAX, imm` 的主操作码。
- **64 位模式下**，需要 **REX.W 前缀（`0x48`）** 来扩展为 `RAX` 和 `imm64`。

#### **（2）立即数（Immediate Value）**
- **32 位模式**：后续 **4 字节**（小端存储）。
- **64 位模式**：后续 **8 字节**（小端存储），需 `REX.W` 前缀。

---

### **3. 示例**
#### **（1）32 位模式**
- **汇编指令**：
  ```asm
  MOV EAX, 0x12345678
  ```
- **机器码**：
  ```
  B8 78 56 34 12
  ```
  - `B8` = `MOV EAX, imm32`
  - `78 56 34 12` = `0x12345678`（小端）

#### **（2）64 位模式**
- **汇编指令**：
  ```asm
  MOV RAX, 0x1122334455667788
  ```
- **机器码**：
  ```
  48 B8 88 77 66 55 44 33 22 11
  ```
  - `48` = REX.W（64 位模式）
  - `B8` = `MOV RAX, imm64`
  - `88 77 66 55 44 33 22 11` = `0x1122334455667788`（小端）

---

### **4. 注意事项**
- **`EAX/RAX` 的特殊用途**：
  - **`EAX`** 常用于存储 **函数返回值**（如 `syscall` 返回值）。
  - **`RAX`** 在 64 位模式下用于 **系统调用号**（Linux x86-64 `syscall`）。
- **16 位模式（历史遗留）**：
  - `0xB8` 在 16 位模式下是 `MOV AX, imm16`（现代代码很少用）。
- **REX.W 前缀（64 位模式）**：
  - 如果没有 `0x48`，`0xB8` 仍然会被解释为 `MOV EAX, imm32`（即使运行在 64 位模式）。

---

### **5. 如何验证？**
#### **（1）使用 `ndisasm` 反汇编**
```bash
echo -ne "\xB8\x78\x56\x34\x12" | ndisasm -b 32 -
```
**输出**：
```
00000000  B878563412        mov eax,0x12345678
```

#### **（2）64 位模式**
```bash
echo -ne "\x48\xB8\x88\x77\x66\x55\x44\x33\x22\x11" | ndisasm -b 64 -
```
**输出**：
```
00000000  48B88877665544332211 mov rax,0x1122334455667788
```

#### **（3）查阅 Intel 手册**
- **Intel® 64 and IA-32 Architectures Software Developer’s Manual**（Volume 2, Chapter 3）的 `MOV` 指令说明。

---

## **总结**
| **机器码** | **汇编指令** | **模式** | **操作** |
|------------|--------------|----------|----------|
| `B8 78 56 34 12` | `MOV EAX, 0x12345678` | 32-bit | 加载 32 位立即数到 `EAX` |
| `48 B8 88 77 66 55 44 33 22 11` | `MOV RAX, 0x1122334455667788` | 64-bit | 加载 64 位立即数到 `RAX` |

`0xB8` 是 `MOV EAX/RAX, imm` 的操作码，具体行为取决于 **CPU 模式** 和 **REX.W 前缀**。